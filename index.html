<!DOCTYPE html>
<html>
	<head>
		<style>
			table,
			th,
			td {
				border: 1px solid black;
				border-collapse: collapse;
			}
			th,
			td {
				padding: 15px;
				text-align: left;
			}
			table#t01 {
				width: 100%;
				background-color: #f1f1c1;
			}
		</style>
	</head>

	<body onLoad="buildHtmlTable('#excelDataTable')">
		<table id="excelDataTable" border="1"></table>
	</body>
</html>
<script>
	var myList = [
		{ name: "abc", age: 50 },
		{ age: "25", hobby: "swimming" },
		{ name: "xyz", hobby: "programming" }
	];

	// Builds the HTML Table out of myList.
	function buildHtmlTable(selector) {
		var columns = addAllColumnHeaders(myList, selector);

		for (var i = 0; i < myList.length; i++) {
			var row$ = $("<tr/>");
			for (var colIndex = 0; colIndex < columns.length; colIndex++) {
				var cellValue = myList[i][columns[colIndex]];
				if (cellValue == null) cellValue = "";
				row$.append($("<td/>").html(cellValue));
			}
			$(selector).append(row$);
		}
	}

	// Adds a header row to the table and returns the set of columns.
	// Need to do union of keys from all records as some records may not contain
	// all records.
	function addAllColumnHeaders(myList, selector) {
		var columnSet = [];
		var headerTr$ = $("<tr/>");

		for (var i = 0; i < myList.length; i++) {
			var rowHash = myList[i];
			for (var key in rowHash) {
				if ($.inArray(key, columnSet) == -1) {
					columnSet.push(key);
					headerTr$.append($("<th/>").html(key));
				}
			}
		}
		$(selector).append(headerTr$);

		return columnSet;
	}
</script>
